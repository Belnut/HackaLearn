name: On Challenge Review Commented

on:
  issue_comment:
    types:
    - created

jobs:
  check_comment:
    # if: ${{ github.event.issue.pull_request }} && ${{ contains(github.event.issue.labels.*.name, 'review-completed') }} && ${{ contains(secrets.PR_REVIEWERS, github.event.issue.user.login) }}
    name: 'Check comment'

    runs-on: ubuntu-latest

    steps:
    - name: Get event payload
      shell: pwsh
      run: |
        Write-Host '${{ toJSON(github.event) }}'

    - name: Get event details
      shell: pwsh
      run: |
        Write-Host '* isPR: ${{ github.event.issue.pull_request }}'
        Write-Host '* body: ${{ github.event.comment.body }}'
        Write-Host '* isValidComment: ${{ github.event.comment.body == '/helloworld' }}'
        Write-Host '* commenter: ${{ github.event.issue.comment.user.login }}'
        Write-Host '* isValidReviewer: ${{ contains(secrets.PR_REVIEWERS, github.event.issue.comment.user.login) }}'
        Write-Host '* labels: ${{ toJSON(github.event.issue.labels.*.name) }}'
        Write-Host '* containLabel: ${{ contains(github.event.issue.labels.*.name, 'ops') }}'
        Write-Host '* containLabel: ${{ contains(github.event.issue.labels.*.name, 'review-completed') }}'

    # - name: Check comment
    #   id: command
    #   uses: xt0rted/slash-command-action@v1
    #   with:
    #     repo-token: ${{ secrets.GITHUB_TOKEN }}
    #     command: ghasignoff
    #     reaction: "true"
    #     reaction-type: "+1"
    #     allow-edits: "false"
    #     permission-level: admin